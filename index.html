<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>In-Hand Salary Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    :root {
      --bg-light: #fafafa;
      --bg-dark: #121212;
      --text-light: #333;
      --text-dark: #f2f2f2;
      --input-bg-light: #eafff2;
      --input-bg-dark: #222;
      --accent: #007b55;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      padding: 30px;
      transition: background 0.3s, color 0.3s;
    }

    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }

    .container {
      max-width: 650px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    body.dark .container {
      background: #1f1f1f;
    }

    h2 {
      margin-bottom: 25px;
      font-size: 22px;
    }

    label {
      display: flex;
      justify-content: space-between;
      margin: 14px 0 6px;
      font-weight: 500;
    }

    input, select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: var(--input-bg-light);
      color: inherit;
      text-align: right;
    }

    body.dark input, body.dark select {
      background: var(--input-bg-dark);
      border: 1px solid #444;
    }

    button {
      margin-top: 20px;
      padding: 12px;
      width: 100%;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      background: var(--accent);
      color: white;
      cursor: pointer;
    }

    .result {
      margin-top: 30px;
      font-size: 17px;
      line-height: 1.6;
    }

    .result p {
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
    }

    .actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .actions button {
      flex: 1;
    }

    .currency::before {
      content: "â‚¹ ";
    }

    .header-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .header-controls select {
      width: 180px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-controls">
      <h2>ðŸ’¼ Salary Calculator</h2>
      <button onclick="toggleDarkMode()">ðŸŒ— Toggle Theme</button>
    </div>

    <label>Income Tax Regime</label>
    <select id="taxRegime">
      <option value="old">Old Regime</option>
      <option value="new">New Regime</option>
    </select>

    <label>Cost to Company (CTC)</label>
    <input type="number" id="ctc" value="600000" />

    <label>Bonus Included in CTC (%)</label>
    <input type="number" id="bonusPercent" value="15" />

    <label>Monthly Professional Tax</label>
    <input type="number" id="ptax" value="200" />

    <label>Monthly Employer PF</label>
    <input type="number" id="employerPf" value="1800" />

    <label>Monthly Employee PF</label>
    <input type="number" id="employeePf" value="1800" />

    <label>Monthly Additional Deduction (Optional)</label>
    <input type="number" id="extra1" value="0" />

    <label>Monthly Additional Deduction (Optional)</label>
    <input type="number" id="extra2" value="0" />

    <div class="actions">
      <button onclick="calculate()">Calculate Salary</button>
      <button onclick="downloadPDF()">Download PDF</button>
    </div>

    <div class="result" id="result"></div>
  </div>

  <script>
    const inputs = [
      'ctc', 'bonusPercent', 'ptax',
      'employerPf', 'employeePf',
      'extra1', 'extra2', 'taxRegime'
    ];

    function calculateOldTax(taxable) {
      let tax = 0;
      if (taxable <= 250000) tax = 0;
      else if (taxable <= 500000) tax = (taxable - 250000) * 0.05;
      else if (taxable <= 1000000)
        tax = 250000 * 0.05 + (taxable - 500000) * 0.2;
      else
        tax = 250000 * 0.05 + 500000 * 0.2 + (taxable - 1000000) * 0.3;
      return Math.round(tax + tax * 0.04); // 4% cess
    }

    function calculateNewTax(taxable) {
      const slabs = [
        [300000, 0],
        [300000, 0.05],
        [300000, 0.1],
        [300000, 0.15],
        [300000, 0.2],
        [Infinity, 0.3]
      ];
      let tax = 0, remaining = taxable;
      for (const [limit, rate] of slabs) {
        const slab = Math.min(remaining, limit);
        tax += slab * rate;
        remaining -= slab;
        if (remaining <= 0) break;
      }
      return Math.round(tax + tax * 0.04);
    }

    function calculate() {
      const ctc = +document.getElementById('ctc').value || 0;
      const bonusPercent = +document.getElementById('bonusPercent').value || 0;
      const ptax = +document.getElementById('ptax').value || 0;
      const employerPf = +document.getElementById('employerPf').value || 0;
      const employeePf = +document.getElementById('employeePf').value || 0;
      const extra1 = +document.getElementById('extra1').value || 0;
      const extra2 = +document.getElementById('extra2').value || 0;
      const regime = document.getElementById('taxRegime').value;

      const annualBonus = (ctc * bonusPercent) / 100;
      const annualEmployerPf = employerPf * 12;
      const annualGross = ctc - annualBonus - annualEmployerPf;
      const monthlyGross = annualGross / 12;

      const annualEmployeePf = employeePf * 12;
      const annualPTax = ptax * 12;
      const annualExtra = (extra1 + extra2) * 12;
      const taxableIncome = annualGross - annualEmployeePf - annualPTax - annualExtra;

      const tax = regime === 'old' ? calculateOldTax(taxableIncome) : calculateNewTax(taxableIncome);
      const monthlyTax = tax / 12;
      const monthlyDeductions = ptax + employeePf + extra1 + extra2 + monthlyTax;
      const annualDeductions = monthlyDeductions * 12;
      const takeHomeMonthly = monthlyGross - monthlyDeductions;
      const takeHomeAnnual = takeHomeMonthly * 12;

      const resultHTML = `
        <p><span>Total Monthly Deductions</span><span>â‚¹${monthlyDeductions.toLocaleString()}</span></p>
        <p><span>Total Annual Deductions</span><span>â‚¹${annualDeductions.toLocaleString()}</span></p>
        <p><span>Take Home Monthly Salary</span><span><strong>â‚¹${takeHomeMonthly.toLocaleString()}</strong></span></p>
        <p><span>Take Home Annual Salary</span><span><strong>â‚¹${takeHomeAnnual.toLocaleString()}</strong></span></p>
      `;

      document.getElementById("result").innerHTML = resultHTML;

      // Save to localStorage
      inputs.forEach(id => localStorage.setItem(id, document.getElementById(id).value));
      localStorage.setItem("salaryResult", resultHTML);
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark");
      localStorage.setItem("darkMode", document.body.classList.contains("dark") ? "yes" : "no");
    }

    function loadSavedData() {
      inputs.forEach(id => {
        if (localStorage.getItem(id))
          document.getElementById(id).value = localStorage.getItem(id);
      });
      if (localStorage.getItem("salaryResult"))
        document.getElementById("result").innerHTML = localStorage.getItem("salaryResult");
      if (localStorage.getItem("darkMode") === "yes")
        document.body.classList.add("dark");
    }

    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(14);
      doc.text("Salary Report", 15, 15);
      const text = document.getElementById("result").innerText;
      doc.text(text.split('\n'), 15, 30);
      doc.save("Salary_Report.pdf");
    }

    window.onload = loadSavedData;
  </script>
</body>
</html>
